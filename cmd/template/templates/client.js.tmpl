// Code generated by {{.GeneratorInfo.Name }}. DO NOT EDIT.
// {{ .GeneratorInfo.Name }} {{ .GeneratorInfo.Version }}

class APIClient {
  async request(path, options = {}) {
    const headers = {
      "Content-Type": "application/json",
      ...(options.headers || {}),
    };

    const response = await fetch(path, {
      ...options,
      headers,
    });

    if (!response.ok) {
      let error = `Error ${response.status}`;
      const text = await response.text();
      try {
          const data = JSON.parse(text);
          error = `Error: ${data.error.message}`;
      } catch (err) {}
      throw new Error(error);
    }

    const text = await response.text();
    try {
      return text ? JSON.parse(text) : {};
    } catch {
      return text;
    }
  }

  get(path) {
    return this.request(path, { method: "GET" });
  }

  post(path, body) {
    return this.request(path, {
      method: "POST",
      body: JSON.stringify(body),
    });
  }

  put(path, body) {
    return this.request(path, {
      method: "PUT",
      body: JSON.stringify(body),
    });
  }

  delete(path) {
    return this.request(path, { method: "DELETE" });
  }

{{ range .Handlers }}
  {{ printf "%s %s" .Name .Description | formatComment }}
  {{ .Name }}({{ .TypeList $.Language }}) {
    {{ if .Params.HasQueryParams }}const query = new URLSearchParams(query_params).toString(); {{ end }}
    return this.{{ .Method | lower }}(`{{ .Path | replace "{" "${" }}{{ if .Params.HasQueryParams }}?${query}{{ end }}` {{if .RequestBodyType }}, body{{ end }})
  }
{{ end }}
}

const api = new APIClient();
